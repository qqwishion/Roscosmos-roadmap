<!-- roadmap_app/templates/universities.html -->
{% extends 'base.html' %}
{% block title %}Вузы — Космический Roadmap{% endblock %}

{% block content %}
<div class="container">
  <h2>Вузы</h2>
  <div class="filters">
    <select id="filter-region"><option value="">Все регионы</option></select>
    <select id="filter-field"><option value="">Все направления</option></select>
    <input id="search-input" placeholder="Поиск по названию">
  </div>

  <div id="list" class="grid-3" style="margin-top:16px;">
    {% for u in universities %}
      <div class="card uni-card" data-region="{{ u.region }}" data-field="{{ u.field }}">
        <h4>{{ u.name }}</h4>
        <p class="muted">{{ u.city }} — {{ u.field }}</p>
        <div class="row">
          <a class="btn btn-small" href="{{ u.website }}" target="_blank">Официальный сайт</a>
        </div>
      </div>
    {% empty %}
      <p>В базе нет вузов.</p>
    {% endfor %}
  </div>
</div>

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', () => {
    const regionSel = document.getElementById('filter-region');
    const fieldSel = document.getElementById('filter-field');
    const search = document.getElementById('search-input');
    const cards = Array.from(document.querySelectorAll('.uni-card'));

    function applyFilters() {
        const r = regionSel.value.toLowerCase();
        const f = fieldSel.value.toLowerCase();
        const q = search.value.toLowerCase();
        cards.forEach(card => {
            const reg = card.dataset.region.toLowerCase();
            const field = card.dataset.field.toLowerCase();
            const name = card.querySelector('h4').textContent.toLowerCase();
            const visible = ((r === '' || reg === r) && (f === '' || field === f) && (q === '' || name.includes(q)));
            card.style.display = visible ? '' : 'none';
        });
    }

    regionSel.addEventListener('change', applyFilters);
    fieldSel.addEventListener('change', applyFilters);
    search.addEventListener('input', applyFilters);
});
</script>
{% endblock %}
{% endblock %}
